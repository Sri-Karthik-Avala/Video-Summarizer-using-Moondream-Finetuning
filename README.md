
---

# Video Summarizer with Moondream2 and Whisper

## Project Overview

The primary objective of this project is to develop a system that can automatically extract key frames from video files, generate descriptive summaries of these frames using the Moondream2 model, and transcribe audio from the videos using the Whisper model. This combined approach allows for a detailed and comprehensive analysis of video content.

The new application, `Video_Summarizer_with_Moondream_and_Whisper.py`, integrates both Moondream2 for visual content analysis and Whisper for audio transcription to create a robust and efficient tool for video analysis.

## Motivation

The motivation behind this project stems from the increasing need for automated video analysis tools in various industries. Traditional methods of video analysis are time-consuming and require significant human effort. By leveraging AI and ML models, we can automate the process of extracting and analyzing key frames from videos, thus saving time and resources.

Furthermore, the ability to transcribe audio from videos and combine it with visual summaries enhances the effectiveness of video content management systems and improves security measures through better surveillance.

## Key Features

- **Key Frame Extraction**: Automatically detects and extracts key frames from videos based on scene changes.
- **Visual Content Analysis**: Utilizes the Moondream2 model to generate detailed descriptions of the extracted key frames.
- **Audio Transcription**: Employs the Whisper model to transcribe audio from video files, providing additional context to the visual content.
- **Integrated Summary Generation**: Combines frame descriptions and audio transcripts to generate a comprehensive summary of the video's content.

## Installation

Ensure you have the necessary Python packages installed. You can install them using pip:

```bash
pip install streamlit opencv-python numpy pillow torch transformers ollama moviepy whisper
```

## Usage

1. **Upload Video**: Start the Streamlit app and upload a video file (formats supported: MP4, MOV, AVI, MKV).
2. **Extract Key Frames**: The application extracts key frames from the video based on scene changes.
3. **Analyze Frames**: Each key frame is analyzed using the Moondream2 model to generate descriptions.
4. **Transcribe Audio**: Audio from the video is transcribed using the Whisper model.
5. **Generate Summary**: A final summary is generated by combining frame descriptions and the audio transcript using Llama3.

Run the application using Streamlit:

```bash
streamlit run Video_Summarizer_with_Moondream_and_Whisper.py
```

## Code Overview

- **`extract_key_frames(video_path, threshold=30)`**: Extracts key frames from the video based on scene changes.
- **`analyze_frame(frame, model)`**: Generates descriptions for each key frame using Moondream2.
- **`transcribe_audio(video_path)`**: Transcribes audio from the video using the Whisper model.
- **`summarize_video_with_llama(summaries, transcript)`**: Combines frame descriptions and audio transcript to generate a final video summary using Llama3.

## Future Enhancements

- **Real-Time Analysis**: Implement real-time video processing for live surveillance applications.
- **Enhanced Descriptions**: Improve the quality and detail of the descriptions generated by Moondream2.
- **User Interface**: Develop a more interactive and user-friendly interface for better user experience.

## Contributing

Contributions are welcome! Please submit a pull request or open an issue if you have suggestions or find any bugs.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for more details.

---
